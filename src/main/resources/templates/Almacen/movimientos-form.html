<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>RIPNEL · Nuevo movimiento</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/app.css}" rel="stylesheet">
</head>
<body th:attr="data-bs-theme=${theme}">

<div th:replace="~{_nav :: bar('Almacén')}"></div>

<main class="container-xxl py-4">
    <h2 class="mb-3 fw-semibold">Registrar movimiento de inventario</h2>

    <form th:action="@{/almacen/movimientos}" th:object="${form}" method="post" class="row g-3">

        <!-- Tipo -->
        <div class="col-12 col-md-4">
            <label class="form-label">Tipo de movimiento</label>
            <select class="form-select" th:field="*{movementType}">
                <option value="IN">IN (Ingreso)</option>
                <option value="OUT">OUT (Salida)</option>
                <option value="TRANSFER">TRANSFER (Transferencia)</option>
            </select>
        </div>

        <!-- Variante -->
        <div class="col-12 col-md-8">
            <label class="form-label">Producto (SKU)</label>
            <select class="form-select" th:field="*{variantId}">
                <option th:each="v : ${variants}"
                        th:value="${v.id}"
                        th:text="${v.sku + ' · ' + v.product.name + ' · ' + v.color.name + ' / ' + v.size.code}">
                    SKU - Producto
                </option>
            </select>
        </div>

        <!-- Ubicación origen -->
        <div class="col-12 col-md-6">
            <label class="form-label">Ubicación origen</label>
            <select class="form-select" th:field="*{fromLocationId}">
                <option th:value="">— Ninguna — (para IN)</option>
                <option th:each="loc : ${locations}"
                        th:value="${loc.id}"
                        th:text="${loc.name}">
                </option>
            </select>
            <div class="form-text">Usar para OUT o TRANSFER.</div>
        </div>

        <!-- Ubicación destino -->
        <div class="col-12 col-md-6">
            <label class="form-label">Ubicación destino</label>
            <select class="form-select" th:field="*{toLocationId}">
                <option th:value="">— Ninguna — (para OUT)</option>
                <option th:each="loc : ${locations}"
                        th:value="${loc.id}"
                        th:text="${loc.name}">
                </option>
            </select>
            <div class="form-text">Usar para IN o TRANSFER.</div>
        </div>

        <!-- Cantidad -->
        <div class="col-12 col-md-4">
            <label class="form-label">Cantidad</label>
            <input type="number" min="1" class="form-control" th:field="*{quantity}">
        </div>

        <!-- Motivo -->
        <div class="col-12 col-md-4">
            <label class="form-label">Motivo</label>
            <select class="form-select" th:field="*{reason}">
                <option th:each="r : ${reasons}" th:value="${r}" th:text="${r}">COMPRA</option>
            </select>
        </div>

        <!-- Nota -->
        <div class="col-12">
            <label class="form-label">Nota</label>
            <textarea class="form-control" rows="2" th:field="*{note}"
                      placeholder="Ej. Reposición a tienda SJL, Ajuste de inventario, etc."></textarea>
        </div>

        <div class="col-12 d-flex gap-2 mt-3">
            <button type="submit" class="btn btn-primary">Guardar movimiento</button>
            <a th:href="@{/almacen/movimientos}" class="btn btn-outline-secondary">Cancelar</a>
        </div>
    </form>

</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
